

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API Reference &mdash; nems 0.2.1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="nems 0.2.1 documentation" href="index.html"/>
        <link rel="prev" title="Quickstart" href="quickstart.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> nems</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install.html#basic">Basic</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart.html#bugs">Bugs</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-nems.models">nems.models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nems.objectives">nems.objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nems.nonlinearities">nems.nonlinearities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nems.tentbasis">nems.tentbasis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nems.sensitivity">nems.sensitivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nems.simulate">nems.simulate</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nems.datastore">nems.datastore</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#roadmap-looking-ahead-to-v1-0">Roadmap (looking ahead to v1.0)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-3-work-in-progress">v0.3 (Work in progress)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-2-february-25-2015">v0.2 (February 25, 2015)</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v0-1-february-22-2015">v0.1 (February 22, 2015)</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">nems</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>API Reference</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/api.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-nems.models">
<span id="nems-models"></span><h2>nems.models<a class="headerlink" href="#module-nems.models" title="Permalink to this headline">¶</a></h2>
<p>Objects for fitting and testing Neural Encoding models</p>
<p>This module provides a set of objects useful for fitting neural encoding models. These are typically probabilistic
models of the response of a sensory neuron to an external stimulus. For example, linear-nonlinear-poisson (LNP) or
generalized linear models (GLMs) fall under this category.</p>
<p>The module exposes classes which contain methods useful for training and testing encoding models given neural data
recorded in an experiment. For more information, see the documentation (TODO: website)</p>
<div class="section" id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><cite>NeuralEncodingModel</cite> &#8211; A super class which contains methods that are common to all encoding models</li>
<li><cite>LNLN</cite> &#8211; A subclass of <cite>NeuralEncodingModel</cite> that fits two layer models consisting of alternating layers of linear filtering and nonlinear thresholding operations. The parameters for the filter and nonlinearities of the first layer are learned, while the linear filter and nonlinearity of the second layer are fixed.</li>
<li><cite>LN</cite> &#8211; A subclass of <cite>NeuralEncodingModel</cite> that fits linear-nonlinear (LN) models using a Gaussian log-likelihood.</li>
</ul>
</div>
<div class="section" id="references">
<h3>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h3>
<p>Coming soon</p>
<dl class="class">
<dt id="nems.models.NeuralEncodingModel">
<em class="property">class </em><tt class="descclassname">nems.models.</tt><tt class="descname">NeuralEncodingModel</tt><big>(</big><em>modeltype</em>, <em>stimulus</em>, <em>rate</em>, <em>filter_dims</em>, <em>minibatch_size</em>, <em>frac_train=0.8</em>, <em>spikes=None</em><big>)</big><a class="headerlink" href="#nems.models.NeuralEncodingModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></a></p>
<p>Neural enoding model object</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#nems.models.NeuralEncodingModel.add_regularizer" title="nems.models.NeuralEncodingModel.add_regularizer"><tt class="xref py py-obj docutils literal"><span class="pre">add_regularizer</span></tt></a>(theta_key,&nbsp;proxfun,&nbsp;**kwargs)</td>
<td>Add a proximal operator / objective to the objective, using the proxalgs package</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#nems.models.NeuralEncodingModel.print_test_results" title="nems.models.NeuralEncodingModel.print_test_results"><tt class="xref py py-obj docutils literal"><span class="pre">print_test_results</span></tt></a>(theta)</td>
<td>Prints a table of test results for the given model parameters</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#nems.models.NeuralEncodingModel.test" title="nems.models.NeuralEncodingModel.test"><tt class="xref py py-obj docutils literal"><span class="pre">test</span></tt></a>(theta)</td>
<td>Evaluate the model on held out data</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nems.models.NeuralEncodingModel.add_regularizer">
<tt class="descname">add_regularizer</tt><big>(</big><em>theta_key</em>, <em>proxfun</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#nems.models.NeuralEncodingModel.add_regularizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a proximal operator / objective to the objective, using the proxalgs package</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>theta_key</strong> : string</p>
<blockquote>
<div><p>The key corresponding to the parameters that this proximal function should be applied to</p>
</div></blockquote>
<p><strong>proxfun</strong> : string</p>
<blockquote>
<div><p>The name of the corresponding function in the proxalgs.operators module</p>
</div></blockquote>
<p><strong>**kwargs</strong> : keyword arguments</p>
<blockquote class="last">
<div><p>Any keyword arguments required by proxfun</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nems.models.NeuralEncodingModel.print_test_results">
<tt class="descname">print_test_results</tt><big>(</big><em>theta</em><big>)</big><a class="headerlink" href="#nems.models.NeuralEncodingModel.print_test_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints a table of test results for the given model parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>theta</strong> : dict</p>
<blockquote class="last">
<div><p>A dictionary of model parameters</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nems.models.NeuralEncodingModel.test">
<tt class="descname">test</tt><big>(</big><em>theta</em><big>)</big><a class="headerlink" href="#nems.models.NeuralEncodingModel.test" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the model on held out data</p>
<p>Relies on the model subclass having a <cite>metrics</cite> method, which accepts an index into the data array and returns
a dictionary containing various metrics evaluated given the current value of the parameters (<cite>theta</cite>) on the
minibatch of data at the given index</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>theta</strong> : dict</p>
<blockquote>
<div><p>The parameters to test</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>results</strong> : DataFrame</p>
<blockquote>
<div><p>A pandas dataframe with the following columsn: the minibatch index, a &#8216;train&#8217; or &#8216;test&#8217; label, and any
keywords returned by the metrics function. Each row in the dataframe consists of the metrics evaluated
on a single minibatch of data.</p>
</div></blockquote>
<p><strong>stats</strong> : dict</p>
<blockquote class="last">
<div><p>Statistics on just the held out minibatches. Keys correspond to the keys in metrics, values are the average
computed over the test minibatches.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Given an initialized and trained instance of NeuralEncodingModel, you can test the model on
held out data as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">results</span><span class="p">,</span> <span class="n">avg</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nems.models.LNLN">
<em class="property">class </em><tt class="descclassname">nems.models.</tt><tt class="descname">LNLN</tt><big>(</big><em>stim</em>, <em>rate</em>, <em>filter_dims</em>, <em>minibatch_size=None</em>, <em>frac_train=0.8</em>, <em>num_subunits=1</em>, <em>num_tents=30</em>, <em>sigmasq=0.2</em>, <em>tent_type='gaussian'</em>, <em>final_nonlinearity='softrect'</em>, <em>spikes=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#nems.models.LNLN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#nems.models.NeuralEncodingModel" title="nems.models.NeuralEncodingModel"><tt class="xref py py-class docutils literal"><span class="pre">nems.models.NeuralEncodingModel</span></tt></a></p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><tt class="xref py py-obj docutils literal"><span class="pre">add_regularizer</span></tt>(theta_key,&nbsp;proxfun,&nbsp;**kwargs)</td>
<td>Add a proximal operator / objective to the objective, using the proxalgs package</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#nems.models.LNLN.f_df" title="nems.models.LNLN.f_df"><tt class="xref py py-obj docutils literal"><span class="pre">f_df</span></tt></a>(W,&nbsp;f,&nbsp;data[,&nbsp;param_gradient])</td>
<td>Evaluate the negative log-likelihood objective and gradient for the LNLN model class</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#nems.models.LNLN.fit" title="nems.models.LNLN.fit"><tt class="xref py py-obj docutils literal"><span class="pre">fit</span></tt></a>([num_alt,&nbsp;max_iter,&nbsp;...])</td>
<td>Runs an optimization algorithm to learn the parameters of the model given training data and regularizers</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#nems.models.LNLN.metrics" title="nems.models.LNLN.metrics"><tt class="xref py py-obj docutils literal"><span class="pre">metrics</span></tt></a>(data_index,&nbsp;theta)</td>
<td>Evaluate metrics on a given minibatch.</td>
</tr>
<tr class="row-odd"><td><tt class="xref py py-obj docutils literal"><span class="pre">print_test_results</span></tt>(theta)</td>
<td>Prints a table of test results for the given model parameters</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#nems.models.LNLN.rate" title="nems.models.LNLN.rate"><tt class="xref py py-obj docutils literal"><span class="pre">rate</span></tt></a>(theta,&nbsp;stim)</td>
<td>Compute the model response given parameters</td>
</tr>
<tr class="row-odd"><td><tt class="xref py py-obj docutils literal"><span class="pre">test</span></tt>(theta)</td>
<td>Evaluate the model on held out data</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nems.models.LNLN.f_df">
<tt class="descname">f_df</tt><big>(</big><em>W</em>, <em>f</em>, <em>data</em>, <em>param_gradient=None</em><big>)</big><a class="headerlink" href="#nems.models.LNLN.f_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the negative log-likelihood objective and gradient for the LNLN model class</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>W</strong> : array_like</p>
<blockquote>
<div><p>A numpy array containing parameter values for the first layer linear filters in the LNLN model</p>
</div></blockquote>
<p><strong>f</strong> : array_like</p>
<blockquote>
<div><p>A numpy array containing parameter values for the first layer nonlinearity in the LNLN model</p>
</div></blockquote>
<p><strong>data</strong> : dict</p>
<blockquote>
<div><p>Dictionary containing two keys: <cite>stim</cite> and <cite>rate</cite>, each of which is a numpy array.</p>
</div></blockquote>
<p><strong>param_gradient</strong> : string (optional, default=None)</p>
<blockquote>
<div><p>A string indicating which parameters to compute the gradient for, either <cite>W</cite> or <cite>f</cite></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>obj_value</strong> : float</p>
<blockquote>
<div><p>The negative log-likelihood objective value. Lower values indicate a better fit to the data.</p>
</div></blockquote>
<p><strong>obj_gradient</strong> : array_like</p>
<blockquote class="last">
<div><p>Contains the gradient (as a numpy array) with respect to the parameters given by <cite>param_gradient</cite></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="n">f_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="nems.models.LNLN.fit">
<tt class="descname">fit</tt><big>(</big><em>num_alt=2</em>, <em>max_iter=20</em>, <em>num_likelihood_steps=50</em>, <em>disp=2</em>, <em>check_grad=None</em><big>)</big><a class="headerlink" href="#nems.models.LNLN.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs an optimization algorithm to learn the parameters of the model given training data and regularizers</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>num_alt</strong> : int, optional</p>
<blockquote>
<div><p>The number of times to alternate between optimizing nonlinearities and optimizing filters. Default: 2</p>
</div></blockquote>
<p><strong>max_iter</strong> : int, optional</p>
<blockquote>
<div><p>The maximum number of steps to take during each leg of the alternating minimization. Default: 25</p>
</div></blockquote>
<p><strong>num_likelihood_steps</strong> : int, optional</p>
<blockquote>
<div><p>The number of steps to take when optimizing the data likelihood term (using SFO)</p>
</div></blockquote>
<p><strong>disp</strong> : int, optional</p>
<blockquote>
<div><p>How much information to display during optimization. (Default: 2)</p>
</div></blockquote>
<p><strong>check_grad</strong> : string, optional</p>
<blockquote class="last">
<div><p>If &#8216;f&#8217; or &#8216;W&#8217;, then the gradient of the log-likelihood objective with respect to that parameter is checked
against a numerical estimate.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>See the <cite>proxalgs</cite> module for more information on the optimization algorithm</p>
</dd></dl>

<dl class="method">
<dt id="nems.models.LNLN.metrics">
<tt class="descname">metrics</tt><big>(</big><em>data_index</em>, <em>theta</em><big>)</big><a class="headerlink" href="#nems.models.LNLN.metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate metrics on a given minibatch.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data_index</strong> : int</p>
<blockquote>
<div><p>An index into the array of minibatches (<cite>self.data</cite>) the evaluate</p>
</div></blockquote>
<p><strong>theta</strong> : dict</p>
<blockquote>
<div><p>The parameters to use in the evaluation</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>metrics</strong> : dict</p>
<blockquote class="last">
<div><p>A dictionary whose keys are the names of metrics applied to evaluate the model parameters on the given
minibatch, and whose values are single numbers.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="#nems.models.NeuralEncodingModel.test" title="nems.models.NeuralEncodingModel.test"><tt class="xref py py-obj docutils literal"><span class="pre">NeuralEncodingModel.test</span></tt></a></dt>
<dd>The <cite>test</cite> function in the super class NeuralEncodingModel relies on the metrics function to return aggregate statistics over all minibatches.</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="nems.models.LNLN.rate">
<tt class="descname">rate</tt><big>(</big><em>theta</em>, <em>stim</em><big>)</big><a class="headerlink" href="#nems.models.LNLN.rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the model response given parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>theta</strong> : dict</p>
<p><strong>stim</strong> : array_like</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>u</strong> : array_like</p>
<p><strong>z</strong> : array_like</p>
<p><strong>zgrad</strong> : array_like</p>
<p><strong>drdz</strong> : array_like</p>
<p class="last"><strong>r</strong> : array_like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nems.models.LN">
<em class="property">class </em><tt class="descclassname">nems.models.</tt><tt class="descname">LN</tt><big>(</big><em>stim</em>, <em>rate</em>, <em>filter_dims</em>, <em>minibatch_size=None</em>, <em>frac_train=0.8</em>, <em>num_tents=30</em>, <em>sigmasq=0.2</em>, <em>tent_type='gaussian'</em>, <em>spikes=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#nems.models.LN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#nems.models.NeuralEncodingModel" title="nems.models.NeuralEncodingModel"><tt class="xref py py-class docutils literal"><span class="pre">nems.models.NeuralEncodingModel</span></tt></a></p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><tt class="xref py py-obj docutils literal"><span class="pre">add_regularizer</span></tt>(theta_key,&nbsp;proxfun,&nbsp;**kwargs)</td>
<td>Add a proximal operator / objective to the objective, using the proxalgs package</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#nems.models.LN.f_df" title="nems.models.LN.f_df"><tt class="xref py py-obj docutils literal"><span class="pre">f_df</span></tt></a>(W,&nbsp;f,&nbsp;data[,&nbsp;param_gradient])</td>
<td>Objective and gradient for fitting the LN model</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#nems.models.LN.fit" title="nems.models.LN.fit"><tt class="xref py py-obj docutils literal"><span class="pre">fit</span></tt></a>()</td>
<td>Runs an optimization algorithm to learn the parameters of the model given training data and regularizers</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#nems.models.LN.metrics" title="nems.models.LN.metrics"><tt class="xref py py-obj docutils literal"><span class="pre">metrics</span></tt></a>(data_index)</td>
<td>Evaluate metrics on a given minibatch</td>
</tr>
<tr class="row-odd"><td><tt class="xref py py-obj docutils literal"><span class="pre">print_test_results</span></tt>(theta)</td>
<td>Prints a table of test results for the given model parameters</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#nems.models.LN.rate" title="nems.models.LN.rate"><tt class="xref py py-obj docutils literal"><span class="pre">rate</span></tt></a>(theta,&nbsp;stim)</td>
<td>Compute the model response given parameters</td>
</tr>
<tr class="row-odd"><td><tt class="xref py py-obj docutils literal"><span class="pre">test</span></tt>(theta)</td>
<td>Evaluate the model on held out data</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nems.models.LN.f_df">
<tt class="descname">f_df</tt><big>(</big><em>W</em>, <em>f</em>, <em>data</em>, <em>param_gradient=None</em><big>)</big><a class="headerlink" href="#nems.models.LN.f_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Objective and gradient for fitting the LN model</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>W</strong> : array_like</p>
<p><strong>f</strong> : array_like</p>
<p><strong>data</strong> : dict</p>
<p><strong>param_gradient</strong> : string, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>obj_value</strong> : float</p>
<p class="last"><strong>obj_gradient</strong> : array_like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nems.models.LN.fit">
<tt class="descname">fit</tt><big>(</big><big>)</big><a class="headerlink" href="#nems.models.LN.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs an optimization algorithm to learn the parameters of the model given training data and regularizers</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>num_alt</strong> : int, optional</p>
<blockquote>
<div><p>The number of times to alternate between optimizing nonlinearities and optimizing filters. Default: 2</p>
</div></blockquote>
<p><strong>max_iter</strong> : int, optional</p>
<blockquote>
<div><p>The maximum number of steps to take during each leg of the alternating minimization. Default: 25</p>
</div></blockquote>
<p><strong>num_likelihood_steps</strong> : int, optional</p>
<blockquote class="last">
<div><p>The number of steps to take when optimizing the data likelihood term (using SFO)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>See the <cite>proxalgs</cite> module for more information on the optimization algorithm</p>
</dd></dl>

<dl class="method">
<dt id="nems.models.LN.metrics">
<tt class="descname">metrics</tt><big>(</big><em>data_index</em><big>)</big><a class="headerlink" href="#nems.models.LN.metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate metrics on a given minibatch</p>
</dd></dl>

<dl class="method">
<dt id="nems.models.LN.rate">
<tt class="descname">rate</tt><big>(</big><em>theta</em>, <em>stim</em><big>)</big><a class="headerlink" href="#nems.models.LN.rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the model response given parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>theta</strong> : dict</p>
<p><strong>stim</strong> : array_like</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>u</strong> : array_like</p>
<p><strong>z</strong> : array_like</p>
<p><strong>zgrad</strong> : array_like</p>
<p><strong>logr</strong> : array_like</p>
<p class="last"><strong>r</strong> : array_like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-nems.objectives">
<span id="nems-objectives"></span><h2>nems.objectives<a class="headerlink" href="#module-nems.objectives" title="Permalink to this headline">¶</a></h2>
<p>Objective functions for computing the negative log-likelihood for different noise models</p>
<p>Computes the negative log-likelihood of a model&#8217;s predicted firing rate given a set of model
parameters and experimental data.</p>
<dl class="function">
<dt id="nems.objectives.gaussian_loglikelihood">
<tt class="descclassname">nems.objectives.</tt><tt class="descname">gaussian_loglikelihood</tt><big>(</big><em>theta</em>, <em>data</em>, <em>modelrate</em>, <em>dt</em>, <em>regularizers</em>, <em>keys=None</em><big>)</big><a class="headerlink" href="#nems.objectives.gaussian_loglikelihood" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="nems.objectives.poisson_loglikelihood">
<tt class="descclassname">nems.objectives.</tt><tt class="descname">poisson_loglikelihood</tt><big>(</big><em>theta</em>, <em>data</em>, <em>theta_fixed</em>, <em>modelrate</em>, <em>dt</em>, <em>regularizers</em><big>)</big><a class="headerlink" href="#nems.objectives.poisson_loglikelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>requirements:</p>
<p>data[&#8216;rate&#8217;] is (1,m) for m time points
data[&#8216;stim&#8217;] is (dim, m)</p>
<dl class="docutils">
<dt>modelrate is a function that returns: the estimated rate r for k cells at m</dt>
<dd>time points with dimensions: (k, m) and gradient, dr, evaluated at theta.
each element of dr must have dimensions: (d1, d2, k, m) or (d, k, m)</dd>
</dl>
<p>dt is a time step (scalar)</p>
<p>regularizers is a dictionary with the same keys as theta
regularizers[key] is a function that takes as an argument the parameter value</p>
<blockquote>
<div>theta[key] and returns the regularization penalty (scalar) and gradient
(same size as theta[key]) at that particular parameter value</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-nems.nonlinearities">
<span id="nems-nonlinearities"></span><h2>nems.nonlinearities<a class="headerlink" href="#module-nems.nonlinearities" title="Permalink to this headline">¶</a></h2>
<p>Nonlinearities and their derivatives</p>
<p>Each function returns the value and derivative of a nonlinearity. Given <span class="math">\(y = f(x)\)</span>, the function returns
<span class="math">\(y\)</span> and <span class="math">\(dy/dx\)</span></p>
<dl class="function">
<dt id="nems.nonlinearities.exp">
<tt class="descclassname">nems.nonlinearities.</tt><tt class="descname">exp</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#nems.nonlinearities.exp" title="Permalink to this definition">¶</a></dt>
<dd><p>An exponential function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : array_like</p>
<blockquote>
<div><p>Input values</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>y</strong> : array_like</p>
<blockquote>
<div><p>The nonlinearity evaluated at the input</p>
</div></blockquote>
<p><strong>dydx</strong> : array_like</p>
<blockquote class="last">
<div><p>The derivative of the nonlinearity evaluated at the input</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nems.nonlinearities.linear">
<tt class="descclassname">nems.nonlinearities.</tt><tt class="descname">linear</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#nems.nonlinearities.linear" title="Permalink to this definition">¶</a></dt>
<dd><p>A linear function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : array_like</p>
<blockquote>
<div><p>Input values</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>y</strong> : array_like</p>
<blockquote>
<div><p>The nonlinearity evaluated at the input</p>
</div></blockquote>
<p><strong>dydx</strong> : array_like</p>
<blockquote class="last">
<div><p>The derivative of the nonlinearity evaluated at the input</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nems.nonlinearities.softrect">
<tt class="descclassname">nems.nonlinearities.</tt><tt class="descname">softrect</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#nems.nonlinearities.softrect" title="Permalink to this definition">¶</a></dt>
<dd><p>Soft rectifying function</p>
<div class="math">
\[y = \log(1+e^x)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> : array_like</p>
<blockquote>
<div><p>Input values</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>y</strong> : array_like</p>
<blockquote>
<div><p>The nonlinearity evaluated at the input</p>
</div></blockquote>
<p><strong>dydx</strong> : array_like</p>
<blockquote class="last">
<div><p>The derivative of the nonlinearity evaluated at the input</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-nems.tentbasis">
<span id="nems-tentbasis"></span><h2>nems.tentbasis<a class="headerlink" href="#module-nems.tentbasis" title="Permalink to this headline">¶</a></h2>
<p>Functions for generating and evaluating functions and gradients
composed of linear combinations of tent basis functions.</p>
<p>This module allows you to:</p>
<ul>
<li><p class="first">Generate tent functions spanning an input range (either Gaussian or Linear tents)</p>
</li>
<li><dl class="first docutils">
<dt>Generate a matrix where the ith column is the value of either the tent function</dt>
<dd><p class="first last"><span class="math">\(\phi(x-i)\)</span> or its derivative <span class="math">\(\phi'(x-i)\)</span> for an input vector x.</p>
</dd>
</dl>
</li>
</ul>
<div class="section" id="notes">
<h3>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h3>
<p>These have the following functional form:</p>
<div class="math">
\[f(x) = \sum_i w_i \phi(x-i)\]</div>
<p>where each tent function <span class="math">\(\phi\)</span> is a _fixed_ basis function, shifted
along the input dimension to tile the input space. The function <span class="math">\(f(x)\)</span>
is parameterized as a linear combination (with weights given by <span class="math">\(lpha\)</span>)
of these tent functions.</p>
<dl class="function">
<dt id="nems.tentbasis.build_tents">
<tt class="descclassname">nems.tentbasis.</tt><tt class="descname">build_tents</tt><big>(</big><em>num_tent_samples</em>, <em>tent_span</em>, <em>num_tents</em>, <em>tent_type='gaussian'</em>, <em>sigmasq=0.2</em><big>)</big><a class="headerlink" href="#nems.tentbasis.build_tents" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize tent basis functions
(used to parameterize nonlinearities)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">tentparams          &#8211; a dictionary containing a bunch of tent basis function parameters:</p>
<blockquote class="last">
<div><p>num_tent_samples, tent_span, num_tents, tent_type, sigmasq (only used for Gaussian tents),
Phi (a matrix whose columns are the basis functions), and centers (an array of tent centers)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nems.tentbasis.eval_basis">
<tt class="descclassname">nems.tentbasis.</tt><tt class="descname">eval_basis</tt><big>(</big><em>u</em>, <em>x</em>, <em>Phi</em>, <em>PhiGrad</em><big>)</big><a class="headerlink" href="#nems.tentbasis.eval_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates a function composed of basis functions given by vectors Phi,
and derivatives given by vectors PhiGrad.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">z       &#8211; the input (u) evaluated at each basis function</p>
<p class="last">zgrad   &#8211; the input (u) evaluated at each basis function derivative</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nems.tentbasis.eval_tents">
<tt class="descclassname">nems.tentbasis.</tt><tt class="descname">eval_tents</tt><big>(</big><em>u</em>, <em>tentparams</em><big>)</big><a class="headerlink" href="#nems.tentbasis.eval_tents" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate basis functions and derivative at given input value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">z, zgrad    &#8211;</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nems.tentbasis.make_rcos_basis">
<tt class="descclassname">nems.tentbasis.</tt><tt class="descname">make_rcos_basis</tt><big>(</big><em>tau</em>, <em>numBases</em>, <em>bias=0.2</em><big>)</big><a class="headerlink" href="#nems.tentbasis.make_rcos_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a raised cosine bases (useful for projecting temporal filters)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Phi       &#8211; the generated basis vectors</p>
<p class="last">PhiOrth   &#8211; the same basis vectors, but orthogonalized</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="module-nems.sensitivity">
<span id="nems-sensitivity"></span><h2>nems.sensitivity<a class="headerlink" href="#module-nems.sensitivity" title="Permalink to this headline">¶</a></h2>
<p>functions to help with sensitivity analysis</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Work in progress</p>
</div>
<dl class="function">
<dt id="nems.sensitivity.ln_hessian">
<tt class="descclassname">nems.sensitivity.</tt><tt class="descname">ln_hessian</tt><big>(</big><em>self</em>, <em>theta</em>, <em>data</em><big>)</big><a class="headerlink" href="#nems.sensitivity.ln_hessian" title="Permalink to this definition">¶</a></dt>
<dd><p>hessian of the LNLN model</p>
</dd></dl>

<dl class="function">
<dt id="nems.sensitivity.lnln_hessian">
<tt class="descclassname">nems.sensitivity.</tt><tt class="descname">lnln_hessian</tt><big>(</big><em>self</em>, <em>theta</em>, <em>data</em><big>)</big><a class="headerlink" href="#nems.sensitivity.lnln_hessian" title="Permalink to this definition">¶</a></dt>
<dd><p>hessian of the LNLN model</p>
</dd></dl>

</div>
<div class="section" id="module-nems.simulate">
<span id="nems-simulate"></span><h2>nems.simulate<a class="headerlink" href="#module-nems.simulate" title="Permalink to this headline">¶</a></h2>
<p>A module for generating data from simulated models</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Work in progress</p>
</div>
<dl class="function">
<dt id="nems.simulate.simulate_LNLN">
<tt class="descclassname">nems.simulate.</tt><tt class="descname">simulate_LNLN</tt><big>(</big><em>self</em>, <em>dim=100</em>, <em>num_tents=30</em>, <em>num_tent_samples=1000</em>, <em>sigmasq=0.1</em>, <em>dt=1</em>, <em>numBatches=100</em>, <em>numSamplesPerBatch=1000</em><big>)</big><a class="headerlink" href="#nems.simulate.simulate_LNLN" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="nems.simulate.simulateexpt">
<tt class="descclassname">nems.simulate.</tt><tt class="descname">simulateexpt</tt><big>(</big><em>self</em>, <em>numBatches=100</em>, <em>numSamplesPerBatch=1000</em><big>)</big><a class="headerlink" href="#nems.simulate.simulateexpt" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulates data from the model</p>
</dd></dl>

</div>
<div class="section" id="module-nems.datastore">
<span id="nems-datastore"></span><h2>nems.datastore<a class="headerlink" href="#module-nems.datastore" title="Permalink to this headline">¶</a></h2>
<p>Store model parameters and function objectives during optimization</p>
<p>This module provides a tools for saving model fitting results (parameters and function evaluations) to a Mongo database
during optimization. It is useful for visualizing learned model parameters in real time (using, for example, a separate
web interface). It is also useful for storing results of a large model fitting procedure such that you have the results
regardless of if python or the machine happens to crash.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Work in progress!</p>
</div>
<div class="section" id="id1">
<h3>Classes<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<ul>
<li><dl class="first docutils">
<dt><cite>Datastore</cite> &#8211; A class for managing a connection to a Mongo database that lets you store model parameters and function</dt>
<dd><p class="first last">objectives.</p>
</dd>
</dl>
</li>
</ul>
<dl class="class">
<dt id="nems.datastore.Datastore">
<em class="property">class </em><tt class="descclassname">nems.datastore.</tt><tt class="descname">Datastore</tt><big>(</big><em>name</em>, <em>desc</em>, <em>headers</em>, <em>host='localhost'</em>, <em>port=27017</em>, <em>dbname='expts'</em><big>)</big><a class="headerlink" href="#nems.datastore.Datastore" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://docs.python.org/library/functions.html#object" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></a></p>
<p>Store parameters and objective values in a mongodb during optimization</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#nems.datastore.Datastore.insert" title="nems.datastore.Datastore.insert"><tt class="xref py py-obj docutils literal"><span class="pre">insert</span></tt></a>(idx,&nbsp;data[,&nbsp;spread])</td>
<td>Insert results for this experiment</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nems.datastore.Datastore.insert">
<tt class="descname">insert</tt><big>(</big><em>idx</em>, <em>data</em>, <em>spread=None</em><big>)</big><a class="headerlink" href="#nems.datastore.Datastore.insert" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert results for this experiment</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="quickstart.html" class="btn btn-neutral" title="Quickstart"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Niru Maheswaranathan.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.2.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>